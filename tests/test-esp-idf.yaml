# CI-Test: Custom Component mit ESP-IDF Framework
esphome:
  name: test-obd2-idf
  friendly_name: "Test OBD2 IDF"

esp32:
  board: m5stack-atoms3
  variant: esp32s3
  framework:
    type: esp-idf

logger:
  level: DEBUG

api:
  encryption:
    key: !secret api_key

ota:
  - platform: esphome
    password: !secret ota_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

external_components:
  - source:
      type: local
      path: ../components
    components: [elm327_ble]

esp32_ble_tracker:
  scan_parameters:
    active: true

ble_client:
  - mac_address: "AA:BB:CC:DD:EE:FF"
    id: elm327_ble_client

elm327_ble:
  id: elm327_hub
  ble_client_id: elm327_ble_client
  service_uuid: "0000FFF0-0000-1000-8000-00805F9B34FB"
  char_tx_uuid: "0000FFF2-0000-1000-8000-00805F9B34FB"
  char_rx_uuid: "0000FFF1-0000-1000-8000-00805F9B34FB"

sensor:
  - platform: elm327_ble
    type: rpm
    name: "Drehzahl"

  - platform: elm327_ble
    type: speed
    name: "Geschwindigkeit"

  - platform: elm327_ble
    type: coolant_temp
    name: "Motortemperatur"

  - platform: elm327_ble
    type: battery_voltage
    name: "Batteriespannung"

text_sensor:
  - platform: elm327_ble
    type: dtc
    name: "Fehlercodes"

binary_sensor:
  - platform: elm327_ble
    type: connected
    name: "ELM327 verbunden"

  - platform: elm327_ble
    type: engine_running
    name: "Motor l√§uft"
